#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸª Running pre-push hook: Generating changelog..."
npm run changelog

if [ $? -ne 0 ]; then
  echo "âŒ Changelog generation failed. Aborting push."
  exit 1
fi

if ! git diff --quiet public/changelog.json; then
  echo "ğŸ“„ Changelog updated â€” committing changes..."
  git add public/changelog.json

  git commit --amend --no-edit

  echo "âœ… Changelog committed. Continuing push..."
else
  echo "â„¹ï¸ No changelog changes detected."
fi
